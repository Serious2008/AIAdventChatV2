# Руководство по анализу проекта

## Что было реализовано

Создана slash-команда `/analyze-project`, которая автоматически анализирует весь проект AIAdventChatV2.

## Как использовать

### В приложении AIAdventChatV2:

1. Откройте чат
2. Введите команду: `/analyze-project`
3. Нажмите Enter
4. Дождитесь результата анализа

### Что делает команда:

**1. Анализ структуры проекта:**
- Строит дерево директорий и файлов
- Определяет основные компоненты (Models, Views, ViewModels, Services)
- Показывает зависимости между модулями

**2. Анализ архитектуры:**
- Определяет используемые паттерны (MVVM, MVC и т.д.)
- Описывает основные сервисы
- Показывает точки интеграции (Claude API, MCP серверы, Yandex Tracker)

**3. Поиск потенциальных проблем:**
- Memory leaks (strong reference cycles)
- Непроверенные опциональные значения
- Отсутствие обработки ошибок
- Потенциальные race conditions
- Хардкод значений
- Дублирование кода

**4. Оценка качества кода:**
- Соблюдение Swift best practices
- Использование async/await
- Обработка ошибок
- Логирование

**5. Рекомендации:**
- Что можно улучшить
- Какие рефакторинги провести
- Где добавить тесты

## Пример использования в Claude Code CLI

Если вы используете Claude Code в терминале:

```bash
# Перейдите в директорию проекта
cd /Users/sergeymarkov/Documents/PetProject/AIAdventChatV2

# Запустите команду
/analyze-project
```

## Расширение для анализа других проектов

Если вы хотите анализировать другие проекты (не AIAdventChatV2), создайте универсальную команду:

```bash
# Создайте файл .claude/commands/analyze-any-project.md
```

С содержимым:
```markdown
---
description: Анализирует структуру любого проекта в текущей директории
---

Проанализируй проект в текущей рабочей директории. Выполни:
1. Определи язык программирования и фреймворки
2. Построй структуру проекта
3. Найди потенциальные баги
4. Дай рекомендации по улучшению
```

## Технические детали

**Расположение файла команды:**
```
/Users/sergeymarkov/Documents/PetProject/AIAdventChatV2/.claude/commands/analyze-project.md
```

**Используемые инструменты:**
- `Glob` - поиск файлов по паттернам
- `Grep` - поиск по содержимому файлов
- `Read` - чтение файлов

**Формат вывода:**
Структурированный отчет с примерами кода, разделенный на секции.

## Ограничения

1. **Размер проекта:** Очень большие проекты (>1000 файлов) могут анализироваться долго
2. **Лимит токенов:** Анализ ограничен 200K токенами контекста
3. **Языки:** Команда оптимизирована для Swift проектов

## Альтернативные способы анализа

### Для анализа конкретной части проекта:

```
Проанализируй ViewModels в проекте и найди потенциальные memory leaks
```

### Для анализа конкретного файла:

```
Проанализируй файл ChatViewModel.swift и найди проблемы
```

### Для построения только структуры:

```
Построй дерево структуры проекта AIAdventChatV2
```

## Пример вывода

После выполнения `/analyze-project` вы получите отчет вида:

```
# АНАЛИЗ ПРОЕКТА AIAdventChatV2

## 1. СТРУКТУРА ПРОЕКТА

AIAdventChatV2/
├── Models/
│   ├── Settings.swift
│   ├── Message.swift
│   └── ...
├── Views/
│   ├── ChatView.swift
│   ├── SettingsView.swift
│   └── ...
├── ViewModels/
│   └── ChatViewModel.swift
├── Services/
│   ├── ClaudeService.swift
│   ├── YandexTrackerService.swift
│   └── ...

## 2. АРХИТЕКТУРА

Паттерн: MVVM (Model-View-ViewModel)
...

## 3. ПОТЕНЦИАЛЬНЫЕ ПРОБЛЕМЫ

### Memory Leaks:
- ChatViewModel.swift:123 - strong reference cycle
...

## 4. РЕКОМЕНДАЦИИ
...
```

## Следующие шаги

1. Попробуйте выполнить `/analyze-project` в вашем приложении
2. Изучите полученный отчет
3. При необходимости попросите уточнить детали: "Расскажи подробнее о найденных memory leaks"
